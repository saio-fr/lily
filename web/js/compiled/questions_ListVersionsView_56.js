lily.ListVersionsView=Backbone.View.extend({tagName:"ul",className:"",id:"list-versions",initialize:function(){this.collection=new lily.ListQuestions;this.collection.url="/"+questionFullView.model.id+"/versions/get";this.collection.fetch({async:false});var listVersions=this.collection.models[0].get("versions");this.collection.add(listVersions);this.collection.remove(this.collection.models[0]);listToComplete=new lily.ListQuestions;listToComplete=this.collection.clone();if(typeof listToComplete.models[0].get("data").answer=="undefined"){listToComplete.models[0].get("data").answer=questionFullView.model.get("answer")}if(typeof listToComplete.models[0].get("data").mood=="undefined"){listToComplete.models[0].get("data").mood=questionFullView.model.get("mood")}if(typeof listToComplete.models[0].get("data").category=="undefined"){if(questionFullView.model.get("category")!==null){listToComplete.models[0].get("data").category=questionFullView.model.get("category")}}var l=1;_.each(listToComplete,function(){if(l<5){if(typeof listToComplete.models[l].get("data").category=="undefined"){listToComplete.models[l].get("data").category=listToComplete.models[l-1].get("data").category}if(typeof listToComplete.models[l].get("data").answer=="undefined"){listToComplete.models[l].get("data").answer=listToComplete.models[l-1].get("data").answer}if(typeof listToComplete.models[l].get("data").mood=="undefined"){listToComplete.models[l].get("data").mood=listToComplete.models[l-1].get("data").mood}}l++});var m=0;_.each(listToComplete,function(){if(listToComplete.models[m].get("data").category!=null){var idCategory=listToComplete.models[m].get("data").category;console.log("idCategory "+idCategory);var colorCategory=app.listCategories.get(idCategory).get("color");var titleCategory=app.listCategories.get(idCategory).get("title");listToComplete.models[m].get("data").category.title=titleCategory;listToComplete.models[m].get("data").category.color=colorCategory}m++});this.collection=listToComplete.clone();this.ChildViews=[]},events:{},render:function(){this.collection.each(function(version){var versionView=new lily.VersionView({model:version});this.ChildViews.push(versionView);this.$el.append(versionView.render().el)},this);return this},close:function(){this.unbind();this.remove();_.each(this.ChildViews,function(childView){if(childView.close){childView.close()}})}});
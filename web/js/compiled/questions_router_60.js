var AppRouter=Backbone.Router.extend({postRequest:_.extend({categories:[null],tags:[null],max:50,page:0,sortBy:{name:"date",order:"DESC"}},Backbone.Events),listCategories:new lily.ListCategories,listRedirections:new lily.ListRedirections,listQuestionsView:null,routes:{"":"all",business:"business","business-detail/:id":"business_detail",personal:"personal","personal-detail/:id":"personal_detail",unanswered:"unanswered","unanswered-detail/:id":"unanswered_detail",spam:"spam",trash:"trash",synonyms:"synonyms","questions-live-chat":"questions_from_chat"},all:function(){app.navigate("business",{trigger:true})},business:function(){if(app.listCategories.length=="0"){app.listCategories.fetch({async:false})}var l=0;_.each(app.listCategories,function(){if(app.listCategories.models[l].get("parent")!=null){var idParent=app.listCategories.models[l].get("parent").id;if(typeof app.listCategories.get(idParent).get("children")=="undefined"){app.listCategories.get(idParent).set({children:new lily.ListCategories})}app.listCategories.get(idParent).get("children").add(app.listCategories.models[l])}l++});_.each(app.listCategories,function(){if(typeof app.listCategories.models[l]!="undefined"){console.log("parent "+app.listCategories.models[l].get("parent"));if(app.listCategories.models[l].get("parent")!==null){app.listCategories.remove(app.listCategories.models[l])}}l++});if(app.listRedirections.length=="0"){app.listRedirections.fetch()}if(typeof questionFullView!=="undefined"){questionFullView.remove();delete QuestionFullView;$("#question-content").addClass("hide")}new lily.LeftMenuView;$(".block-answered").find(".title-block-meter").addClass("active");$("#wrapper-unanswered").addClass("collapse");if(typeof appQuestionUnansweredView!="undefined"){appQuestionUnansweredView.close();delete appQuestionUnansweredView}if(typeof appQuestionPersonalView!="undefined"){appQuestionPersonalView.close();delete appQuestionPersonalView}if(typeof appQuestionView=="undefined"){appQuestionView=new lily.AppQuestionView}$(".meter-business-questions").addClass("active")},business_detail:function(id){new lily.LeftMenuView;$("#wrapper-unanswered").addClass("collapse");$(".block-answered").find(".title-block-meter").addClass("active");$(".block-answered").find(".meter-business-questions").addClass("active");if(typeof appQuestionView=="undefined"){appQuestionView=new lily.AppQuestionView;$("#contenant-page").prepend(appQuestionView.el)}var modelToDisplay=new lily.Question;modelToDisplay.url="/get/"+id;modelToDisplay.fetch({async:false});if(typeof questionFullView!=="undefined"){questionFullView.remove()}questionFullView=new lily.QuestionBusinessFullView({model:modelToDisplay})},personal:function(){new lily.LeftMenuView;$("#wrapper-unanswered").addClass("collapse");$(".block-answered").find(".title-block-meter").addClass("active");$(".block-answered").find(".meter-personal-questions").addClass("active");if(typeof appQuestionView!=="undefined"){appQuestionView.close();delete appQuestionView}if(typeof appQuestionUnansweredView!=="undefined"){appQuestionUnansweredView.close();delete appQuestionUnansweredView}if(typeof questionFullView!=="undefined"){$("#question-content").addClass("hide");questionFullView.remove();delete questionFullView}appQuestionPersonalView=new lily.AppQuestionPersonalView},personal_detail:function(id){new lily.LeftMenuView;$(".meter-personal-questions").addClass("active");$("#wrapper-unanswered").addClass("collapse");if(typeof appQuestionView!=="undefined"){appQuestionView.close();delete appQuestionView}if(typeof appQuestionUnansweredView!=="undefined"){appQuestionUnansweredView.close();delete appQuestionUnansweredView}if(typeof appQuestionPersonalView=="undefined"){appQuestionPersonalView=new lily.AppQuestionPersonalView}if(typeof questionFullView!=="undefined"){questionFullView.remove()}var questionToDisplay=new lily.Question;questionToDisplay.url="/personal/get/"+id;questionToDisplay.fetch({success:function(){questionFullView=new lily.QuestionPersonalFullView({model:questionToDisplay})}})},unanswered:function(){if(app.listCategories.length=="0"){app.listCategories.fetch({async:false})}new lily.LeftMenuView;$("#nombre-questions").find(".active").removeClass("active");$(".meter-unanswered-questions").addClass("active");$("#wrapper-answered").addClass("collapse");if(typeof appQuestionPersonalView!=="undefined"){appQuestionPersonalView.close();delete appQuestionPersonalView}if(typeof appQuestionView!=="undefined"){appQuestionView.close();delete appQuestionView}if(typeof questionFullView!=="undefined"){$("#question-content").addClass("hide");questionFullView.remove();delete questionFullView}appQuestionUnansweredView=new lily.AppQuestionUnansweredView},unanswered_detail:function(id){if(app.listCategories.length=="0"){app.listCategories.fetch({async:false})}if($("#question-content").children().length=="0"||typeof fullQuesionView!=="undefined"&&fullQuesionView.model.id!==id){$("#nombre-questions").children(".active").removeClass("active");$(".meter-unanswered-questions").addClass("active");$("#wrapper-answered").addClass("collapse");new lily.LeftMenuView;if(typeof appQuestionPersonalView!=="undefined"){appQuestionPersonalView.close();delete appQuestionPersonalView}if(typeof appQuestionView!=="undefined"){appQuestionView.close();delete appQuestionView}appQuestionUnansweredView=new lily.AppQuestionUnansweredView;var modelToDisplay=new lily.Question;modelToDisplay.url="/unanswered/get/"+id;modelToDisplay.fetch({async:false});questionFullView=new lily.QuestionUnansweredFullView({model:modelToDisplay})}else{app.navigate("unanswered",{trigger:true})}},spam:function(){new lily.LeftMenuView;$("#wrapper-answered").addClass("collapse");$(".meter-spam-questions").addClass("active");$("#list-questions").children().remove()},trash:function(){new lily.LeftMenuView;$(".meter-trash-questions").addClass("active");$("#wrapper-unanswered").addClass("collapse")},questions_from_chat:function(){new lily.LeftMenuView;$(".meter-live-chat-questions").addClass("active");$("#wrapper-answered").addClass("collapse")},synonyms:function(){new lily.LeftMenuView;$("#nombre-questions").find(".active").removeClass("active");$(".meter-synonyms").addClass("active");$("#wrapper-answered").addClass("collapse");$("#wrapper-unanswered").addClass("collapse")}});